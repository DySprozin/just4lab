<?phpdefined ('ROOT') or exit();class Cls_Kvak { public $ingroup = array(); //Массив группа => пользователи public $chmod = array(); //Массив группа => доступ  private $user; //текущий пользователь private $groups = array(); //группы, к которым принадлежит текущий юзер public function __construct() {  $this->user = empty($GLOBALS['user']) ? 'guest' : $GLOBALS['user'];    $ingroup_path = ROOT . 'conf/kvak/groups/';  $ingroup_array = scandir($ingroup_path);  foreach ($ingroup_array as $groups) {   if ($groups == '.' || $groups == '..') continue;   $this->ingroup[$groups] = file($ingroup_path . $groups);  }  //print_r ($ingroup_array);  foreach ($this->ingroup as $group => $users) {   if (in_array($this->user, $users)) {    $this->groups[] = $group;  }  	//echo $group;  } } }class Cls_Kvak_Items extends Cls_Kvak { ## #Структура создания пункта квака, которую запоняем вручную public $img_src = ''; public $a_title = ''; public $img_alt = ''; public $img_class = 'img_right_menu'; public $div_class = 'border_right_menu'; // | border_right_menu2line public $f = 'n/a'; public $title = ''; public $title2 = ''; public $active = 'off'; # ## /** Конструктор с указанием доступа (по умолчанию - для всех только чтение)* @param string - (all, guest, reguser, group1, moder, numuser)* @param string - (r--, rw-, rwx, ---), x - создавать темы*/ public function __construct() {  parent::__construct();  $this->chmod['all'] = 'rwx';  $this->chmod['Guest'] = 'r--';  $this->chmod['Admin'] = 'rwx'; }  public function kvak() {  if ($this->chmod['all'] == '---') return '';  if ($this->active == 'off') {   $link = <<< LINK    <a class="right_link_kva" href="/kvak/$this->f/" title='$this->a_title'>$this->title</a> $this->title2LINK;  }  else {   $link = <<< LINK    <a href="#main_top" class="visited" onclick="blink('actual_title')">$this->title</a> $this->title2</a>LINK;  }  $new_kvak = <<<KVAK     <img src="$this->img_src" alt="$this->img_alt" class="$this->img_class">   <div class="$this->div_class">    $link   </div>   <br class="break">KVAK;  return $new_kvak; }}